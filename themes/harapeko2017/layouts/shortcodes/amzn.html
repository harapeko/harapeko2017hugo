{{/*
Usage:
  {{< amzn B07496Z2GC "http://google.co.jp/" >}}
  {{< amzn B07496Z2GC >}}

Params:
  第一: string ASIN    必須
  第二: string 画像パス 画像指定したい時に使用する(URLは記号があるので「""」で囲みます)

備考:
  getJSONしているところは、自分で用意したJSONまたはAPIに置き換えてください
  参考：https://github.com/harapeko/amazon_pa_api_by_php
*/}}

{{ $api := getenv "AMAZON_PRODUCT_API" }}
{{ $itemId := index .Params 0 }}
{{ $json := getJSON $api $itemId }}
<div class="sc-amzn">
  {{ with $json.title }}<p class="title">{{ . }}</p>{{ end }}
  {{ if $json.author }}
    <p class="author">{{ $json.author }}</p>
  {{ else if $json.manufacturer }}
    <p class="manufacturer">{{ $json.manufacturer }}</p>
  {{ end }}
  <div class="media">
    <div class="images">
      {{/* 指定、中、大、小の優先順位で画像を表示します。基本的には中サイズの画像が使われる想定です */}}
      <amp-img class="img" src="{{ index .Params 1 | default $json.images.medium | default $json.images.large | default $json.images.smalls }}" alt="{{ $json.title }}" width="200" height="200" layout="responsive"></amp-img>
    </div>
    <div class="info">
      {{ with $json.item_url }}<div class="btn"><a class="detail" href="{{ . }}" target="_blank">詳しくみる</a></div>{{ end }}
      {{ with $json.cr_url }}<div class="btn"><a class="review" href="{{ . }}" target="_blank">評判をみる</a></div>{{ end }}
      {{ with $json.wish_url }}<div class="btn"><a class="wish" href="{{ . }}" target="_blank">ほしい物に追加</a></div>{{ end }}
    </div>
  </div>
</div>